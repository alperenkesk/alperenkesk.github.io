<!DOCTYPE html>
<html lang="tr"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Thick Client Sızma Testi: DLL Hijacking | Alperen Keskin</title>
<meta property="og:title" content="Thick Client Sızma Testi: DLL Hijacking | Alperen Keskin" />
<meta name="twitter:title" content="Thick Client Sızma Testi: DLL Hijacking | Alperen Keskin" />
<meta itemprop="name" content="Thick Client Sızma Testi: DLL Hijacking | Alperen Keskin" />
<meta name="application-name" content="Thick Client Sızma Testi: DLL Hijacking | Alperen Keskin" />
<meta property="og:site_name" content="Alperen Keskin Blog" />

<meta name="description" content="Siber Güvenlik ve yazılım blogu">
<meta itemprop="description" content="Siber Güvenlik ve yazılım blogu" />
<meta property="og:description" content="Siber Güvenlik ve yazılım blogu" />
<meta name="twitter:description" content="Siber Güvenlik ve yazılım blogu" />

<meta property="og:locale" content="tr" />
<meta name="language" content="tr" />

  <link rel="alternate" hreflang="tr" href="https://alperenkesk.github.io/posts/pentest-teknikleri/dll-hijacking/" title="Türkçe" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2026-01-25T15:00:00&#43;0300 />
    <meta property="article:published_time" content=2026-01-25T15:00:00&#43;0300 />
    <meta property="og:url" content="https://alperenkesk.github.io/posts/pentest-teknikleri/dll-hijacking/" />

    
    <meta property="og:article:author" content="Alperen Keskin" />
    <meta property="article:author" content="Alperen Keskin" />
    <meta name="author" content="Alperen Keskin" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Thick Client Sızma Testi: DLL Hijacking",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2026-01-25",
        "description": "",
        "wordCount":  811 ,
        "mainEntityOfPage": "True",
        "dateModified": "2026-01-25",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Alperen Keskin"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.154.0">

    
    <meta property="og:url" content="https://alperenkesk.github.io/posts/pentest-teknikleri/dll-hijacking/">
  <meta property="og:site_name" content="Alperen Keskin">
  <meta property="og:title" content="Thick Client Sızma Testi: DLL Hijacking">
  <meta property="og:description" content="Modern Windows uygulamaları, fonksiyonelliklerini modüler hale getirmek için Dynamic Link Library (DLL) dosyalarına güvenir. Ancak bu güven ilişkisi, kütüphane arama hiyerarşisindeki mantıksal hatalarla birleştiğinde Red Team operasyonlarında yetki yükseltme ve kalıcılık sağlayan kritik bir DLL Hijacking zafiyetine dönüşür.
Bu yazıda, DLL Hijacking mekanizmasının anatomisini, Windows’un kütüphane arama hiyerarşisini ve bu zafiyetin tespit-doğrulama-exploit döngüsünü teknik ayrıntılarıyla ele alıyoruz.
1. DLL Hijacking Nedir? DLL Hijacking, bir uygulamanın ihtiyaç duyduğu orijinal (benign) kütüphaneyi (.dll) ararken izlediği yol üzerindeki bir boşluğa, saldırganın zararlı bir dosyayı yerleştirmesi işlemidir. Uygulama, kütüphanenin tam yolunu (absolute path) bilmediği durumlarda Windows Loader’ın arama algoritmasına güvenir.">
  <meta property="og:locale" content="tr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-25T15:00:00+03:00">
    <meta property="article:modified_time" content="2026-01-25T15:00:00+03:00">
    <meta property="article:tag" content="Red Team">
    <meta property="article:tag" content="Thick Client">
    <meta property="article:tag" content="DLL Hijacking">
    <meta property="article:tag" content="Pentest">
    <meta property="article:tag" content="Windows Security">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Thick Client Sızma Testi: DLL Hijacking">
  <meta name="twitter:description" content="Modern Windows uygulamaları, fonksiyonelliklerini modüler hale getirmek için Dynamic Link Library (DLL) dosyalarına güvenir. Ancak bu güven ilişkisi, kütüphane arama hiyerarşisindeki mantıksal hatalarla birleştiğinde Red Team operasyonlarında yetki yükseltme ve kalıcılık sağlayan kritik bir DLL Hijacking zafiyetine dönüşür.
Bu yazıda, DLL Hijacking mekanizmasının anatomisini, Windows’un kütüphane arama hiyerarşisini ve bu zafiyetin tespit-doğrulama-exploit döngüsünü teknik ayrıntılarıyla ele alıyoruz.
1. DLL Hijacking Nedir? DLL Hijacking, bir uygulamanın ihtiyaç duyduğu orijinal (benign) kütüphaneyi (.dll) ararken izlediği yol üzerindeki bir boşluğa, saldırganın zararlı bir dosyayı yerleştirmesi işlemidir. Uygulama, kütüphanenin tam yolunu (absolute path) bilmediği durumlarda Windows Loader’ın arama algoritmasına güvenir.">


    

    <link rel="canonical" href="https://alperenkesk.github.io/posts/pentest-teknikleri/dll-hijacking/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://alperenkesk.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-2JM75S6REN"></script>
      <script>
        var doNotTrack = false;
        if ( true ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-2JM75S6REN');
        }
      </script>
    
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://alperenkesk.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Anasayfa
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Yazılar
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/pages/about/">
                        Hakkımda
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Thick Client Sızma Testi: DLL Hijacking</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2026-01-25T15:00:00&#43;03:00" itemprop="datePublished"> 25 Oca 2026 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b></b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#1-dll-hijacking-nedir">1. DLL Hijacking Nedir?</a></li>
    <li><a href="#2-windows-dll-arama-sırası-search-order">2. Windows DLL Arama Sırası (Search Order)</a></li>
    <li><a href="#3-tespit-ve-analiz-süreci">3. Tespit ve Analiz Süreci</a>
      <ul>
        <li><a href="#31-process-monitor-ile-filtreleme">3.1 Process Monitor ile Filtreleme</a></li>
        <li><a href="#32-name-not-found-hatalarının-analizi">3.2 &ldquo;NAME NOT FOUND&rdquo; Hatalarının Analizi</a></li>
        <li><a href="#33-icacls-ile-exploit-edilebilirliğin-doğrulanması">3.3 icacls ile Exploit Edilebilirliğin Doğrulanması</a></li>
      </ul>
    </li>
    <li><a href="#4-exploit-aşaması-zararlı-dll-hazırlama">4. Exploit Aşaması: Zararlı DLL Hazırlama</a>
      <ul>
        <li><a href="#41-mimari-uyumu-x86-vs-x64">4.1 Mimari Uyumu (x86 vs x64)</a></li>
        <li><a href="#42-payload-mantığı">4.2 Payload Mantığı</a></li>
        <li><a href="#önemli-metodoloji-notu">Önemli Metodoloji Notu</a></li>
      </ul>
    </li>
    <li><a href="#5-savunma-ve-önleme">5. Savunma ve Önleme</a>
      <ul>
        <li><a href="#görsel-referansları">Görsel Referansları</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <p>Modern Windows uygulamaları, fonksiyonelliklerini modüler hale getirmek için <strong>Dynamic Link Library (DLL)</strong> dosyalarına güvenir. Ancak bu güven ilişkisi, kütüphane arama hiyerarşisindeki mantıksal hatalarla birleştiğinde Red Team operasyonlarında <strong>yetki yükseltme ve kalıcılık</strong> sağlayan kritik bir <strong>DLL Hijacking zafiyetine</strong> dönüşür.</p>
<p>Bu yazıda, DLL Hijacking mekanizmasının anatomisini, Windows&rsquo;un kütüphane arama hiyerarşisini ve bu zafiyetin tespit-doğrulama-exploit döngüsünü teknik ayrıntılarıyla ele alıyoruz.</p>
<hr>
<h2 id="1-dll-hijacking-nedir">1. DLL Hijacking Nedir?</h2>
<p>DLL Hijacking, bir uygulamanın ihtiyaç duyduğu orijinal (benign) kütüphaneyi (.dll) ararken izlediği yol üzerindeki bir boşluğa, saldırganın zararlı bir dosyayı yerleştirmesi işlemidir. Uygulama, kütüphanenin tam yolunu (<strong>absolute path</strong>) bilmediği durumlarda Windows Loader&rsquo;ın arama algoritmasına güvenir.</p>
<p>Eğer saldırgan, loader sistem dizinine bakmadan önce kütüphaneyi bulabileceği bir konuma (örneğin uygulamanın kendi dizinine) yazma yetkisine sahipse, uygulama orijinal (benign) kütüphane yerine saldırganın kodunu belleğe yükler ve execute eder.</p>
<hr>
<h2 id="2-windows-dll-arama-sırası-search-order">2. Windows DLL Arama Sırası (Search Order)</h2>
<p>Windows, bir DLL çağrılırken belirli bir hiyerarşiyi takip eder. Standart (<strong>Safe</strong>) arama sırası şu şekildedir:</p>
<ol>
<li><strong>Uygulamanın Yüklendiği Dizin:</strong> Uygulamanın .exe dosyasının bulunduğu klasör.</li>
<li><strong>Sistem Dizini:</strong> <code>C:\Windows\System32</code></li>
<li><strong>16-bit Sistem Dizini:</strong> <code>C:\Windows\System</code></li>
<li><strong>Windows Dizini:</strong> <code>C:\Windows</code></li>
<li><strong>Mevcut Çalışma Dizini (Current Directory)</strong></li>
<li><strong>PATH Ortam Değişkenindeki Dizinler</strong></li>
</ol>
<blockquote>
<p><strong>Kritik Nokta:</strong> Zafiyet genellikle uygulamanın 1. sırada bulamadığı bir dosyayı 2. sıradaki sistem dizininde araması, ancak saldırganın 1. sıradaki dizine müdahale edebilmesiyle (yazma yetkisi) ortaya çıkar.</p>
</blockquote>
<hr>
<h2 id="3-tespit-ve-analiz-süreci">3. Tespit ve Analiz Süreci</h2>
<p>Bu teorik yapıyı somutlaştırmak için <strong>DVTA</strong> (Damn Vulnerable Thick Client Application) örneği üzerinden metodolojiyi inceleyelim.</p>
<h3 id="31-process-monitor-ile-filtreleme">3.1 Process Monitor ile Filtreleme</h3>
<p>Exploit öncesi tespit aşamasında uygulama çalışırken <strong>Process Monitor (ProcMon)</strong> üzerinde gürültüyü azaltacak şu filtreler sırasıyla uygulanır:</p>
<figure><img src="/images/image1.png"><figcaption>
      <h4>Görsel 1 - Process Name Filtresi (DVTA.exe)</h4>
    </figcaption>
</figure>

<figure><img src="/images/image2.png"><figcaption>
      <h4>Görsel 2 - Path Filtresi (ends with .dll)</h4>
    </figcaption>
</figure>

<figure><img src="/images/image3.png"><figcaption>
      <h4>Görsel 3 - Result Filtresi (NAME NOT FOUND)</h4>
    </figcaption>
</figure>

<h3 id="32-name-not-found-hatalarının-analizi">3.2 &ldquo;NAME NOT FOUND&rdquo; Hatalarının Analizi</h3>
<p>Filtreleme sonucunda uygulamanın kendi dizini altında bulamadığı dosyalar listelenir.</p>
<figure><img src="/images/image4.png"><figcaption>
      <h4>Görsel 4 - NAME NOT FOUND Listesi</h4>
    </figcaption>
</figure>

<p>Görsel 4&rsquo;te görüldüğü üzere, <code>DVTA.exe</code> süreci çalışma dizini içerisinde <strong>ncrypt.dll</strong> dosyasını sorgulamakta fakat &ldquo;NAME NOT FOUND&rdquo; yanıtı almaktadır. Bu durum, Windows Loader&rsquo;ın arama hiyerarşisinde sistem dizinlerine geçmeden hemen önce, uygulama dizini seviyesinde bir DLL Hijacking manipülasyonuna imkan tanımaktadır.</p>
<h3 id="33-icacls-ile-exploit-edilebilirliğin-doğrulanması">3.3 icacls ile Exploit Edilebilirliğin Doğrulanması</h3>
<p>Tespit edilen boşluğun exploit edilebilir olması için saldırganın o dizine dosya yazabilmesi gerekir.</p>
<figure><img src="/images/image5.png"><figcaption>
      <h4>Görsel 5 - icacls Çıktısı (student kullanıcısı F yetkisi)</h4>
    </figcaption>
</figure>

<p>Görsel 5&rsquo;te yapılan sorgulama, düşük yetkili kullanıcının (student) ilgili dizin üzerinde <strong>(F)</strong> yani <strong>Full Access</strong> yetkisine sahip olduğunu gösterir. Ancak gerçek dünya senaryolarında sadece (F) değil, şu izin kombinasyonları da exploit için yeterlidir:</p>
<ul>
<li><strong>(F) - Full Access:</strong> Dizin üzerinde dosya oluşturma, silme ve izinleri değiştirme dahil her türlü yetkiyi verir.</li>
<li><strong>(M) - Modify:</strong> Dosya oluşturma ve silme yetkisi verir. DLL Hijacking için en yaygın exploit noktasıdır.</li>
<li><strong>(W) - Write:</strong> Dizin içine yeni dosya yazılmasına izin verir. Mevcut dosyaları silemeseniz bile &ldquo;eksik&rdquo; olan DLL&rsquo;i buraya koymanızı sağlar.</li>
<li><strong>(AD) - Append Data:</strong> Mevcut veriyi değiştiremese bile yeni dosya/veri eklenmesine olanak tanır.</li>
<li><strong>(OI)(CI):</strong> &ldquo;Object Inherit&rdquo; ve &ldquo;Container Inherit&rdquo; anlamına gelir; bu izinlerin alt dosya ve klasörlere otomatik olarak miras kaldığını kanıtlar.</li>
</ul>
<hr>
<h2 id="4-exploit-aşaması-zararlı-dll-hazırlama">4. Exploit Aşaması: Zararlı DLL Hazırlama</h2>
<p>İzinler doğrulandıktan sonra, eksik olan <code>ncrypt.dll</code> (veya hedef DLL) dosyasının yerine geçecek bir payload hazırlamamız gerekir.</p>
<p>Saldırı senaryosunu gerçekleştirmek için <strong>Custom DLL Payloads</strong> (msfvenom veya özel kaynak kodları) ile hazırlanan zararlı <strong>ncrypt.dll</strong> dosyası, uygulamanın arama yaptığı dizine yerleştirilir. Uygulama bir sonraki açılışında, Windows Loader mekanizması sistem dizininden (<code>System32</code>) önce uygulamanın kendi dizinine bakacağı için orijinal kütüphane yerine bizim yerleştirdiğimiz zararlı kütüphaneyi yükler. Böylece payload&rsquo;umuz hedef uygulamanın yetkileriyle çalıştırılmış olur.</p>
<blockquote>
<p><strong>Hazır Exploit Dosyaları:</strong>
Bu analizde kullanılan exploit kaynak kodlarına ve <strong>derlenmiş hazır exploit dosyalarına (x86/x64)</strong> <a href="https://github.com/alperenkesk/DLL-Hijacking-PoC">GitHub Repomdan (DLL-Hijacking-PoC)</a> ulaşabilirsiniz. Testlerinizde zaman kazanmak için <code>bin/</code> klasöründeki hazır DLL&rsquo;leri kullanabilirsiniz.</p>
</blockquote>
<h3 id="41-mimari-uyumu-x86-vs-x64">4.1 Mimari Uyumu (x86 vs x64)</h3>
<p>Sızma testlerinde en sık yapılan hata mimari uyuşmazlığıdır. Windows Loader, 64-bit bir sürecin içine 32-bit bir DLL (veya tam tersi) yükleyemez.</p>
<ul>
<li>Hedef uygulama <strong>32-bit</strong> ise -&gt; <code>exploit32.dll</code></li>
<li>Hedef uygulama <strong>64-bit</strong> ise -&gt; <code>exploit64.dll</code></li>
</ul>
<h3 id="42-payload-mantığı">4.2 Payload Mantığı</h3>
<p>Repodaki zararlı DLL&rsquo;in çalışma mantığı oldukça basittir. <code>DLL_PROCESS_ATTACH</code> olayı tetiklendiğinde (yani uygulama DLL&rsquo;i yüklediği anda) kanıt olması amacıyla <code>calc.exe</code> (Hesap Makinesi) çalıştırılır.</p>
<p>Örnek C kodu:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BOOL</span> <span class="n">APIENTRY</span> <span class="nf">DllMain</span><span class="p">(</span><span class="n">HMODULE</span> <span class="n">hModule</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">DWORD</span>  <span class="n">ul_reason_for_call</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">LPVOID</span> <span class="n">lpReserved</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="p">(</span><span class="n">ul_reason_for_call</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">DLL_PROCESS_ATTACH</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">WinExec</span><span class="p">(</span><span class="s">&#34;calc.exe&#34;</span><span class="p">,</span> <span class="n">SW_SHOW</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">DLL_THREAD_ATTACH</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">DLL_THREAD_DETACH</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">DLL_PROCESS_DETACH</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Bu yapı, zafiyetin başarılı bir şekilde tetiklendiğini doğrulamak için yeterlidir.</p>
<blockquote>
<h3 id="önemli-metodoloji-notu">Önemli Metodoloji Notu</h3>
<p>Analiz sürecinde unutulmaması gereken en kritik nokta şudur: <strong>Her &ldquo;NAME NOT FOUND&rdquo; hatası bir zafiyet değildir.</strong> Bir uygulamanın eksik bir DLL araması potansiyel bir fırsat olsa da, bu durum <code>icacls</code> ile dosya sistemi izinleri seviyesinde doğrulanmadığı sürece sadece bir log kaydıdır. Gerçek bir zafiyet, &ldquo;eksik dosya&rdquo; ile &ldquo;yetersiz izinlerin&rdquo; kesiştiği noktada doğar.</p>
</blockquote>
<hr>
<h2 id="5-savunma-ve-önleme">5. Savunma ve Önleme</h2>
<p>Zafiyeti önlemek için geliştiricilerin ve sistem yöneticilerinin alabileceği temel önlemler:</p>
<ul>
<li><strong>Absolute Path:</strong> <code>LoadLibrary</code> çağrılarında DLL&rsquo;in tam yolu belirtilmelidir.</li>
<li><strong>İzin Yönetimi:</strong> Uygulama dizinlerinde <code>Users</code> grubuna sadece <em>Read &amp; Execute</em> yetkisi verilmeli, yazma yetkisi kesinlikle kısıtlanmalıdır.</li>
<li><strong>API Kısıtlamaları:</strong> <code>SetDefaultDllDirectories</code> kullanılarak arama dizinleri sadece güvenli yollarla sınırlandırılmalıdır.</li>
</ul>
<hr>
<h3 id="görsel-referansları">Görsel Referansları</h3>
<p>Bu yazıdaki teknik süreci görselleştirmek amacıyla kullanılan materyaller aşağıdaki kaynaklardan alınmıştır:</p>
<ul>
<li><a href="https://medium.com/@ahmedmehsania/thick-client-pentesting-methodology-and-checklist-part-2-6cf0bbee0927">Thick Client Pentesting Methodology</a></li>
<li><a href="https://github.com/unixsingh/Thick-Client-Penetration-Testing">Thick Client Penetration Testing Guide</a></li>
<li><a href="https://medium.com/@arinjoy.manna/pentester-academy-julys-lab-sprint-dll-hijacking-for-privilege-escalation-64c85add809b">DLL Hijacking for Privilege Escalation</a></li>
</ul>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2026 Alperen Keskin.
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://alperenkesk.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
